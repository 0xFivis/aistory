# ==================== 系统级配置 ====================
# 复制本文件为 .env 并按需修改。所有敏感凭证请通过后端配置管理 API 写入数据库，而非直接写在 .env。

# 数据库连接
DATABASE_URL=mysql+pymysql://user:password@localhost:3306/aistory

# API 服务器
API_HOST=0.0.0.0
API_PORT=8010
API_DEBUG=true

# 时区设置（示例：Asia/Shanghai，或 UTC）
APP_TIMEZONE=Asia/Shanghai

# 允许的前端来源（逗号分隔）。部署到局域网时请改为实际前端地址，例如 http://192.168.1.10:5173
CORS_ALLOW_ORIGINS=http://localhost:5173,http://127.0.0.1:5173

# Provider 默认选择（JSON 字符串）
PROVIDER_DEFAULTS={"storyboard":"gemini","image":"runninghub","audio":"fishaudio","video":"ffmpeg","video_prompt":"gemini","media_compose":"ffmpeg","scene_merge":"ffmpeg","finalize":"ffmpeg"}

# ==================== Celery & Redis ====================
REDIS_URL=redis://localhost:6379/0
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# Celery broker 重连策略
CELERY_BROKER_CONNECTION_RETRY=true
CELERY_BROKER_CONNECTION_RETRY_ON_STARTUP=true

# Service concurrency defaults (fallback when DB 未配置)
# 示例: {"runninghub":{"image":3,"video":3}}
SERVICE_CONCURRENCY_DEFAULTS={"runninghub":{"image":3,"video":3},"fishaudio":{"audio":1},"ffmpeg":{"video":5}}

# ==================== 代理配置 ====================
# 留空则不使用代理，格式: http://host:port 或 socks5://host:port
HTTP_PROXY=
HTTPS_PROXY=

PROXY_PROXY1_URL=
PROXY_PROXY2_URL=
PROXY_SERVICE_MAP=
# 不需要代理的服务（逗号分隔），例如: localhost,127.0.0.1,192.168.*
NO_PROXY=localhost,127.0.0.1
# 需要代理的服务列表（逗号分隔）- 空则全部服务都不使用代理
# PROXY_ENABLED_SERVICES=gemini,fishaudio

# ==================== 存储与日志 ====================
STORAGE_BASE_PATH=./storage
STORAGE_TEMP_PATH=./storage/temp
STORAGE_PUBLIC_BASE_URL=http://localhost:8010

LOG_LEVEL=DEBUG
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s

# ==================== Faster Whisper ====================
# 根据部署环境选择模型与设备。CPU 环境可改为 "cpu" 和 "int8"。
FASTER_WHISPER_MODEL=medium
FASTER_WHISPER_DEVICE=cpu
FASTER_WHISPER_COMPUTE_TYPE=int8

# 模型缓存目录，按需修改。
FASTER_WHISPER_DOWNLOAD_ROOT=/opt/models
# 若需离线运行，可开启 HF_HUB_OFFLINE=1 并提前下载模型
# HF_HUB_OFFLINE=1

# ==================== 说明 ====================
# 1. 云服务 API Keys、音色 ID、模型 ID 等敏感信息请通过数据库管理界面或
#    脚本导入（例如 python scripts/import_all_config.py），不要写在 .env。
# 2. 更新本文件后记得重启后端服务和 Celery worker。
